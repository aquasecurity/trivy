{"id":"1234","title":"nsa","description":"National Security Agency - Kubernetes Hardening Guidance","severity":"1.0","relatedResources":["http://related-resource/"],"checksResults":[{"id":"1.0","name":"Non-root containers","description":"Check that container is not running as root","severity":"MEDIUM","checksResults":[{"Target":"Deployment/metrics-server","Class":"config","Type":"kubernetes","MisconfSummary":{"Successes":1,"Failures":0,"Exceptions":0},"Misconfigurations":[{"Type":"Kubernetes Security Check","ID":"KSV001","AVDID":"AVD-KSV-0001","Title":"Process can elevate its own privileges","Description":"A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.","Message":"Container 'metrics-server' of Deployment 'metrics-server' should set 'securityContext.allowPrivilegeEscalation' to false","Namespace":"builtin.kubernetes.KSV001","Query":"data.builtin.kubernetes.KSV001.deny","Resolution":"Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.","Severity":"MEDIUM","PrimaryURL":"https://avd.aquasec.com/misconfig/ksv001","References":["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted","https://avd.aquasec.com/misconfig/ksv001"],"Status":"PASS","Layer":{},"CauseMetadata":{"Provider":"Kubernetes","Service":"general","StartLine":132,"EndLine":140,"Code":{"Lines":[{"Number":132,"Content":"                - image: rancher/metrics-server:v0.3.6","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":true,"LastCause":false},{"Number":133,"Content":"                  imagePullPolicy: IfNotPresent","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":134,"Content":"                  name: metrics-server","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":135,"Content":"                  resources: {}","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":136,"Content":"                  terminationMessagePath: /dev/termination-log","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":137,"Content":"                  terminationMessagePolicy: File","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":138,"Content":"                  volumeMounts:","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":139,"Content":"                    - mountPath: /tmp","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":140,"Content":"                      name: tmp-dir","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":true}]}}}]},{"Target":"defaultt/metrics-2","Class":"config","Type":"kubernetes","MisconfSummary":{"Successes":1,"Failures":0,"Exceptions":0},"Misconfigurations":[{"Type":"Kubernetes Security Check","ID":"KSV001","AVDID":"AVD-KSV-0001","Title":"Process can elevate its own privileges","Description":"A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.","Message":"Container 'metrics-server' of Deployment 'metrics-server' should set 'securityContext.allowPrivilegeEscalation' to false","Namespace":"builtin.kubernetes.KSV001","Query":"data.builtin.kubernetes.KSV001.deny","Resolution":"Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.","Severity":"MEDIUM","PrimaryURL":"https://avd.aquasec.com/misconfig/ksv001","References":["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted","https://avd.aquasec.com/misconfig/ksv001"],"Status":"FAIL","Layer":{},"CauseMetadata":{"Provider":"Kubernetes","Service":"general","StartLine":132,"EndLine":140,"Code":{"Lines":[{"Number":132,"Content":"                - image: rancher/metrics-server:v0.3.6","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":true,"LastCause":false},{"Number":133,"Content":"                  imagePullPolicy: IfNotPresent","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":134,"Content":"                  name: metrics-server","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":135,"Content":"                  resources: {}","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":136,"Content":"                  terminationMessagePath: /dev/termination-log","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":137,"Content":"                  terminationMessagePolicy: File","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":138,"Content":"                  volumeMounts:","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":139,"Content":"                    - mountPath: /tmp","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":140,"Content":"                      name: tmp-dir","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":true}]}}}]}]},{"id":"1.1","name":"Immutable container file systems","description":"Check that container root file system is immutable","severity":"LOW","checksResults":[{"Target":"Deployment/metrics-server","Class":"config","Type":"kubernetes","MisconfSummary":{"Successes":1,"Failures":0,"Exceptions":0},"Misconfigurations":[{"Type":"Kubernetes Security Check","ID":"KSV003","AVDID":"AVD-KSV-0003","Title":"Default capabilities not dropped","Description":"The container should drop all default capabilities and add only those that are needed for its execution.","Message":"Container 'metrics-server' of Deployment 'metrics-server' should add 'ALL' to 'securityContext.capabilities.drop'","Namespace":"builtin.kubernetes.KSV003","Query":"data.builtin.kubernetes.KSV003.deny","Resolution":"Add 'ALL' to containers[].securityContext.capabilities.drop.","Severity":"LOW","PrimaryURL":"https://avd.aquasec.com/misconfig/ksv003","References":["https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/","https://avd.aquasec.com/misconfig/ksv003"],"Status":"FAIL","Layer":{},"CauseMetadata":{"Provider":"Kubernetes","Service":"general","StartLine":132,"EndLine":140,"Code":{"Lines":[{"Number":132,"Content":"                - image: rancher/metrics-server:v0.3.6","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":true,"LastCause":false},{"Number":133,"Content":"                  imagePullPolicy: IfNotPresent","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":134,"Content":"                  name: metrics-server","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":135,"Content":"                  resources: {}","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":136,"Content":"                  terminationMessagePath: /dev/termination-log","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":137,"Content":"                  terminationMessagePolicy: File","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":138,"Content":"                  volumeMounts:","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":139,"Content":"                    - mountPath: /tmp","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":140,"Content":"                      name: tmp-dir","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":true}]}}}]},{"Target":"defaultt/metrics-2","Class":"config","Type":"kubernetes","MisconfSummary":{"Successes":1,"Failures":0,"Exceptions":0},"Misconfigurations":[{"Type":"Kubernetes Security Check","ID":"KSV003","AVDID":"AVD-KSV-0003","Title":"Default capabilities not dropped","Description":"The container should drop all default capabilities and add only those that are needed for its execution.","Message":"Container 'metrics-server' of Deployment 'metrics-server' should add 'ALL' to 'securityContext.capabilities.drop'","Namespace":"builtin.kubernetes.KSV003","Query":"data.builtin.kubernetes.KSV003.deny","Resolution":"Add 'ALL' to containers[].securityContext.capabilities.drop.","Severity":"LOW","PrimaryURL":"https://avd.aquasec.com/misconfig/ksv003","References":["https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/","https://avd.aquasec.com/misconfig/ksv003"],"Status":"PASS","Layer":{},"CauseMetadata":{"Provider":"Kubernetes","Service":"general","StartLine":132,"EndLine":140,"Code":{"Lines":[{"Number":132,"Content":"                - image: rancher/metrics-server:v0.3.6","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":true,"LastCause":false},{"Number":133,"Content":"                  imagePullPolicy: IfNotPresent","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":134,"Content":"                  name: metrics-server","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":135,"Content":"                  resources: {}","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":136,"Content":"                  terminationMessagePath: /dev/termination-log","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":137,"Content":"                  terminationMessagePolicy: File","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":138,"Content":"                  volumeMounts:","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":139,"Content":"                    - mountPath: /tmp","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":false},{"Number":140,"Content":"                      name: tmp-dir","IsCause":true,"Annotation":"","Truncated":false,"FirstCause":false,"LastCause":true}]}}}]}]},{"id":"1.2","name":"tzdata - new upstream version","description":"Bad tzdata package","severity":"CRITICAL","checksResults":[{"Target":"rancher/metrics-server:v0.3.6 (debian 9.9)","Class":"os-pkgs","Type":"debian","Vulnerabilities":[{"VulnerabilityID":"DLA-2424-1","VendorIDs":["DLA-2424-1"],"PkgName":"tzdata","InstalledVersion":"2019a-0+deb9u1","FixedVersion":"2020d-0+deb9u1","Layer":{"DiffID":"sha256:932da51564135c98a49a34a193d6cd363d8fa4184d957fde16c9d8527b3f3b02"},"DataSource":{"ID":"debian","Name":"Debian Security Tracker","URL":"https://salsa.debian.org/security-tracker-team/security-tracker"},"Title":"tzdata - new upstream version","Severity":"UNKNOWN"}]}]}]}